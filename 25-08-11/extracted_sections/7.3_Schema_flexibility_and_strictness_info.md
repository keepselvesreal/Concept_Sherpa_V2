# 추가 정보

## 핵심 내용
JSON Schema에서 맵(객체)의 필드는 기본적으로 선택적(optional)이며, 필수 필드로 만들려면 `required` 배열에 명시해야 합니다. 또한 스키마에 정의되지 않은 추가 속성은 기본적으로 허용되지만, `additionalProperties: false`로 설정하여 엄격하게 제한할 수 있습니다. 데이터 검증 시에는 "보내는 데이터는 엄격하게, 받는 데이터는 유연하게"라는 견고성 원칙을 따르는 것이 좋은 관례이며, 이는 DOP의 데이터 스키마와 데이터 표현 분리 원칙을 실무에 적용하는 핵심적인 방법입니다.

## 상세 핵심 내용
### JSON Schema의 유연성과 엄격성 제어

JSON Schema는 DOP의 4번째 원칙인 데이터 스키마와 표현의 분리를 구현하는 핵심 도구로서, 데이터 검증에서 유연성과 엄격성 사이의 세밀한 균형을 제공합니다. 특히 시스템 경계에서의 데이터 검증에서 이러한 제어 능력이 중요한 역할을 합니다.

### 필수 필드와 선택적 필드의 설계 원칙

JSON Schema에서 객체의 모든 필드는 기본적으로 선택적(optional)입니다. 이는 클래스 기반 검증과 다른 접근법으로, 필수 필드를 명시적으로 `required` 배열에 선언해야 합니다.

**도서 검색 응답의 실제 사례**:
```json
[
  {
    "title": "7 Habits of Highly Effective People",
    "available": true,
    "isbn": "978-0812981605",
    "subtitle": "Powerful Lessons in Personal Change",
    "number_of_pages": 432
  },
  {
    "title": "The Power of Habit",
    "available": false,
    "isbn_13": "978-1982137274",
    "subtitle": "Why We Do What We Do in Life and Business",
    "subjects": ["Social aspects", "Habit", "Change (Psychology)"]
  }
]
```

이 예시에서 `title`과 `available`만 필수이고 나머지는 선택적으로 설계되었으며, 이는 다양한 도서 정보 소스에서 일관되지 않은 데이터 구조를 수용하면서도 핵심 정보는 보장하는 전략입니다.

### 스키마 구성과 재사용성

JSON Schema가 일반적인 맵 구조로 표현되므로, 클래스 정의보다 높은 조합성과 재사용성을 제공합니다:

```javascript
var bookInfoSchema = {
  "type": "object",
  "required": ["title", "available"],
  "properties": {
    "title": {"type": "string"},
    "available": {"type": "boolean"},
    "subtitle": {"type": "string"},
    "number_of_pages": {"type": "integer"},
    "subjects": {
      "type": "array",
      "items": {"type": "string"}
    },
    "isbn": {"type": "string"},
    "isbn_13": {"type": "string"}
  }
};

var searchBooksResponseSchema = {
  "type": "array",
  "items": bookInfoSchema
};
```

이러한 조합성은 복잡한 시스템에서 스키마를 모듈화하고 재사용할 수 있게 하여, 전체적인 데이터 검증 아키텍처의 일관성을 유지하는 데 기여합니다.

### 시스템 경계에서의 외부 데이터 검증

외부 데이터 소스에서 받은 데이터를 검증하는 것은 시스템 경계 보호의 핵심입니다. 데이터베이스 응답처럼 내부 시스템이라도 데이터 구조가 예상과 다를 수 있어 검증이 필요합니다:

```javascript
var booksFromDBSchema = {
  "type": "array",
  "items": {
    "type": "object",
    "required": ["title", "isbn", "available"],
    "properties": {
      "title": {"type": "string"},
      "available": {"type": "boolean"},
      "isbn": {"type": "string"}
    }
  }
};
```

### additionalProperties를 통한 스키마 엄격성 제어

JSON Schema의 가장 중요한 특징 중 하나는 기본적으로 스키마에 정의되지 않은 추가 필드를 허용한다는 점입니다. 이는 시스템의 유연성을 제공하지만, 때로는 엄격한 제어가 필요합니다.

**문제가 될 수 있는 예시**:
```json
[
  {
    "title": "7 Habits of Highly Effective People",
    "available": true,
    "isbn": "978-0812981605",
    "dummy_property": 42
  }
]
```

엄격한 검증이 필요한 경우 `additionalProperties: false`를 설정합니다:

```javascript
var strictBooksSchema = {
  "type": "array",
  "items": {
    "type": "object",
    "required": ["title", "isbn", "available"],
    "additionalProperties": false,
    "properties": {
      "title": {"type": "string"},
      "available": {"type": "boolean"},
      "isbn": {"type": "string"}
    }
  }
};
```

### 견고성 원칙(Robustness Principle)의 실제 적용

Jon Postel의 견고성 원칙 **"보내는 것은 보수적으로, 받아들이는 것은 관대하게"**는 시스템 경계에서의 데이터 검증 전략을 결정하는 핵심 지침입니다.

**실무적 적용 전략**:
- **클라이언트 요청 검증**: `additionalProperties: true` (기본값) - 미래 확장성과 클라이언트 유연성 제공
- **서버 응답 검증**: `additionalProperties: false` - 클라이언트에게 일관된 데이터 구조 보장
- **외부 API 응답**: 상황에 따라 유연하게 적용 - 외부 시스템의 변경 사항에 대한 내성 확보

### 유연성과 엄격성의 전략적 균형

이러한 접근법은 DOP에서 추구하는 데이터 중심적 사고와 완벽히 부합합니다:

1. **시스템 내부 안정성**: 경계에서의 철저한 검증으로 내부 시스템의 예측 가능성 확보
2. **외부 호환성**: 적절한 유연성을 통해 다양한 외부 시스템과의 원활한 통합
3. **진화 가능성**: 스키마의 점진적 확장이 가능한 구조로 장기적 시스템 발전 지원
4. **오류 최소화**: 명확한 검증 규칙을 통해 런타임 오류 가능성 대폭 감소

이러한 특성들이 결합되어 JSON Schema는 실제 운영 환경에서 유연하면서도 안정적인 데이터 검증을 가능하게 하며, DOP의 데이터 검증 철학을 실현하는 실용적 도구로 기능합니다.

## 주요 화제
- JSON Schema의 필드 요구사항(required fields): JSON Schema에서 필드는 기본적으로 선택사항이며, 필수 필드로 만들려면 required 배열에 명시해야 함

- Schema 구성 및 재구조화(schema composition): JSON Schema를 변수로 분리하여 재사용 가능하게 만들고, 중첩된 스키마를 더 읽기 쉽게 리팩토링하는 방법

- 외부 데이터 소스 유효성 검사: 데이터베이스나 외부 API로부터 받은 데이터를 검증하는 모범 사례와 그 중요성

- additionalProperties 설정: JSON Schema에서 스키마에 정의되지 않은 추가 속성들의 허용 여부를 제어하는 방법과 기본값이 true인 이유

- 데이터 송수신 시 유연성과 엄격성의 균형: 요청 데이터는 유연하게 받아들이고 응답 데이터는 엄격하게 관리하는 Postel의 견고성 원칙 적용

## 부차 화제
- JSON Schema에서 필드의 필수/선택 사항 설정: required 배열을 사용하여 필수 필드를 지정하고, 맵의 필드는 기본적으로 선택 사항임

- 스키마의 구성과 재사용성: JSON Schema를 별도의 변수로 분리하여 재사용 가능하게 만들고 중첩을 줄여 가독성을 향상시키는 방법

- 외부 데이터 소스 검증의 중요성: 데이터베이스나 외부 API에서 받은 데이터를 검증하는 것이 좋은 관례라는 점

- additionalProperties 설정: JSON Schema에서 스키마에 명시되지 않은 추가 필드를 허용하거나 금지하는 방법과 기본값

- 요청과 응답에서의 유연성과 엄격성 원칙: 클라이언트 요청에는 유연하게, 서버 응답에는 엄격하게 대응하는 Jon Postel의 견고성 원칙

- 개인적 습관과 독서: Joe가 손톱 물어뜯는 습관을 고치기 위해 "The Power of Habit" 책을 읽고 있다는 일화
