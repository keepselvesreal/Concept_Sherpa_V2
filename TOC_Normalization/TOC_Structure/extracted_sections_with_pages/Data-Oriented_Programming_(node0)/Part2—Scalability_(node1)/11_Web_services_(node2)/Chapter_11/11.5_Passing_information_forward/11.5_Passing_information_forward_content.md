# 11.5 Passing information forward

**페이지**: 261-262
**계층**: Data-Oriented Programming (node0) > Part2—Scalability (node1) > 11 Web services (node2) > Chapter 11
**추출 시간**: 2025-08-06 19:47:14

---


--- 페이지 261 ---

11.5 Passing information forward 233
Listing11.10 A map with book information from the database
var dataFromDb = {
"available": true,
"isbn": "978-1982137274"
};
Listing11.11 A map with book information from the Open Library Books API
var dataFromOpenLib = {
"title":"7 Habits of Highly Effective People : Revised and Updated",
"subtitle":"Powerful Lessons in Personal Change",
"number_of_pages":432,
"full_title":"7 Habits of Highly Effective People : \
Revised and Updated Powerful Lessons in Personal Change",
"publish_date":"2020",
"publishers":["Simon & Schuster, Incorporated"]
};
Joe After calling _.merge, the result is a map with fields from both maps.
Listing11.12 Merging two maps
_.merge(dataFromDb, dataFromOpenLib);
//{
// "available": true,
// "full_title": "7 Habits of Highly Effective People :\
// Revised and Updated Powerful Lessons in Personal Change",
// "isbn": "978-1982137274",
// "number_of_pages": 432,
// "publish_date": "2020",
// "publishers": [ "Simon & Schuster, Incorporated"],
// "subtitle": "Powerful Lessons in Personal Change",
// "title": "7 Habits of Highly Effective People : Revised and Updated"
//}
Theo Let me code the JSON schema for the search books response. Here’s how that
would look.
Listing11.13 JSON schema for search books response
var searchBooksResponseSchema = {
"type": "object",
"required": ["title", "isbn", "available"],
"properties": {
"title": {"type": "string"},
"available": {"type": "boolean"},
"publishers": {
"type": "array",
"items": {"type": "string"}
},
"number_of_pages": {"type": "integer"},
"weight": {"type": "string"},

--- 페이지 261 끝 ---


--- 페이지 262 ---

234 CHAPTER 11 Web services
"physical_format": {"type": "string"},
"subjects": {
"type": "array",
"items": {"type": "string"}
},
"isbn": {"type": "string"},
"publish_date": {"type": "string"},
"physical_dimensions": {"type": "string"}
}
};
Theo Yes! I think we now have all the pieces to enrich our search results.
11.6 Search result enrichment in action
Joe Can you write the steps of the enrichment data flow?
Theo Sure.
Theo goes to the whiteboard. He takes a moment to gather his thoughts, and then erases
enough space so there’s room to list the steps.
The steps for the search result enrichment data flow
1 Receive a request from a client.
2 Extract from the client’s request the query and the fields to fetch from Open
Library.
3 Retrieve from the database the books that match the query.
4 Fetch information from Open Library for each ISBN that match the query.
5 Extract from Open Library responses for the required fields.
6 Combine book information from the database with information from Open
Library.
7 Send the response to the client.
Joe Perfect! Would you like to try to implement it?
Theo I think I’ll start with the implementation of the book retrieval from the data-
base. It’s quite similar to what we did last month.
 NOTE See chapter 10 for last month’s lesson.
Joe Actually, it’s even simpler because you don’t need to join tables.
Theo That’s right, I need values only for the isbn and available columns.
Theo works for a bit in his IDE. He begins with the book retrieval from the database.
Listing11.14 Retrieving books whose title matches a query
var dbSearchResultSchema = {
"type": "array",
"items": {

--- 페이지 262 끝 ---
