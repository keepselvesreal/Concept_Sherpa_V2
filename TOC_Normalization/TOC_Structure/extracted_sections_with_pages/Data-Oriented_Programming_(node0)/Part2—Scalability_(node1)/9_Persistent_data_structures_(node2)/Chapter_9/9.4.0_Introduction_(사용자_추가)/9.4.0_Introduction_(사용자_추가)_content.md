# 9.4.0 Introduction (사용자 추가)

**페이지**: 213-214
**계층**: Data-Oriented Programming (node0) > Part2—Scalability (node1) > 9 Persistent data structures (node2) > Chapter 9
**추출 시간**: 2025-08-06 19:47:07

---


--- 페이지 213 ---

9.3 Persistent data structures libraries 185
Joe Take for instance, Paguro for Java. Paguro persistent maps implement the
read-only methods of java.util.Map like get() and containsKey(), but not
methods like put() and remove(). On the other hand, Paguro vectors imple-
ment the read-only methods of java.util.List like get() and size(), but not
methods like set().
Theo What happens when we call put() or remove() on a Paguro map?
Joe It throws an UnSupportedOperationException exception.
Theo What about iterating over the elements of a Paguro collection with a forEach()?
Joe That works like it would in any Java collection. Here, let me show you an example.
Listing9.5 Iterating over a Paguro vector
var myVec = PersistentVector.ofIter(
List.of(10, 2, 3));
Creates a Paguro
vector from a
for (Integer i : myVec) {
Java list
System.out.println(i);
}
Theo What about Java streams?
Joe Paguro collections are Java collections, so they support the Java stream inter-
face. Take a look at this code.
Listing9.6 Streaming a Paguro vector
var myVec = PersistentVector.ofIter(List.of(10, 2, 3));
vec1.stream().sorted().map(x -> x + 1);
TIP Paguro collections implement the read-only parts of Java collection interfaces.
Therefore, they can be passed to any methods that expect to receive a Java collection
without mutating it.
Theo So far, you told me how do use Paguro collections as Java read-only collections.
How do I make modifications to Paguro persistent data structures?
Joe In a way similar to the _.set() function of Lodash FP that we talked about
earlier. Instead of mutating in place, you create a new version.
Theo What methods does Paguro expose for creating new versions of a data structure?
Joe For vectors, you use replace(), and for maps, you use assoc().
Listing9.7 Creating a modified version of a Paguro vector
var myVec = PersistentVector.ofIter(List.of(10, 2, 3));
var myNextVec = myVec.replace(0, 42);

--- 페이지 213 끝 ---


--- 페이지 214 ---

186 CHAPTER 9 Persistent data structures
Listing9.8 Creating a modified version of a Paguro map
var myMap = PersistentHashMap.of(Map.of("aa", 1, "bb", 2)
.entrySet());
Creates a Paguro map
from a Java map entry set
var myNextMap = myMap.assoc("aa", 42);
Theo Yes! Now I see how to use persistent data structures in Java, but what about
JavaScript?
9.3.2 Persistent data structures in JavaScript
Joe In a language like JavaScript, it’s a bit more cumbersome to integrate per-
sistent data structures.
Theo How so?
Joe Because JavaScript objects and arrays don’t expose any interface.
Theo Bummer.
Joe It’s not as terrible as it sounds because Immutable.js exposes its own set of
functions to manipulate its data structures.
Theo What do you mean?
Joe I’ll show you in a moment. But first, let me show you how to initiate Immutable.js
persistent data structures.
Theo OK!
Joe Immutable.js provides a handy function that recursively converts a native data
object to an immutable one. It’s called Immutable.fromJS().
Theo What do you mean by recursively?
Joe Consider the map that holds library data from our Library Management Sys-
tem: it has values that are themselves maps. Immutable.fromJS() converts the
nested maps into immutable maps.
Theo Could you show me some code?
Joe Absolutely. Take a look at this JavaScript code for library data.
Listing9.9 Conversion to immutable data
var libraryData = Immutable.fromJS({
"catalog": {
"booksByIsbn": {
"978-1779501127": {
"isbn": "978-1779501127",
"title": "Watchmen",
"publicationYear": 1987,
"authorIds": ["alan-moore",
"dave-gibbons"]
}
},
"authorsById": {
"alan-moore": {
"name": "Alan Moore",

--- 페이지 214 끝 ---
