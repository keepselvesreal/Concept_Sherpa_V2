# 12.1 Function arguments validation

**페이지**: 278-280
**계층**: Data-Oriented Programming (node0) > Part3—Maintainability (node1) > 12 Advanced data validation (node2) > Chapter 12
**추출 시간**: 2025-08-06 19:47:16

---


--- 페이지 278 ---

250 CHAPTER 12 Advanced data validation
Theo Dave, please remind me of the expected shapes for catalogData and query.
Dave Sure. query should be a string, and catalogData should be a map that con-
forms to the catalog data model.
Theo What is the catalog data model?
Dave Let me see. I have seen a diagram of it somewhere.
Dave rummages around a bit in his folder for Klafim’s Library Management System. Find-
ing what he’s looking for, he draws the diagram in figure 12.1 on the whiteboard.
C Catalog
booksByIsbn: {Book}
authorsById: {Author}
C Book
C Author
title : String
publicationYear: Number id: String
isbn: String name: String
authorlds: [String] booklsbns: [String]
bookltems: [Bookltem]
C Bookltem
id: String
libld: String
purchaseDate: String
isLent: Boolean
Figure 12.1 The catalog data model
 NOTE The schemas for this book use JSON Schema version 2020-12.
Theo Can you write a JSON Schema for the catalog data model?
Dave Am I allowed to use internal variables for book and author schemas, or do I
have to nest all the schemas inside the catalog schema?
Theo JSON Schema is part of the code. If you feel that using internal variables would
make the code more readable, go for it.
Dave OK. Now I need the JSON Schema gift that Joe gave you.
Theo picks up a well-worn piece of paper that is a bit torn and quite wrinkled. He gives
Dave the JSON Schema cheat sheet.
Listing12.2 JSON Schema cheat sheet
At the root level,
{
data is an array.
"type": "array",
"items": { Each element of the array is a map.
"type": "object",
The properties of each field in the map
"properties": {

--- 페이지 278 끝 ---


--- 페이지 279 ---

12.1 Function arguments validation 251
"myNumber": {"type": "number"},
myNumber
"myString": {"type": "string"}, myEnum is an enumeration
is a number.
"myEnum": {"enum": ["myVal", "yourVal"]}, value with two possibilities,
myString is "myBool": {"type": "boolean"} "myVal" and "yourVal".
a string. },
"required": ["myNumber", "myString"], myBool is a boolean.
"additionalProperties": false
} The mandatory fields in the map
} We don’t allow fields that are not are myNumber and myString.
explicitly mentioned in the schema. Other fields are optional.
Dave I think I’ll start with the author schema. It seems simpler than the book schema.
Quickly composing the code, Dave shows Theo the author schema. Dave, still new to DOP,
looks for Theo’s reaction.
Listing12.3 The author schema
var authorSchema = {
"type": "object",
"required": ["id", "name", "bookIsbns"],
"properties": {
"id": {"type": "string"},
"name": {"type": "string"},
"bookIsbns": {
"type": "array",
"items": {"type": "string"}
}
}
};
Theo Well done! Let’s move on to the book schema now.
Dave I think I am going to store the book item schema in a variable.
Listing12.4 The book item schema
var bookItemSchema = {
"type": "object",
"properties":{
"id": {"type": "string"},
"libId": {"type": "string"},
"purchaseDate": {"type": "string"},
"isLent": {"type": "boolean"}
},
"required": ["id", "libId", "purchaseDate", "isLent"]
};
var bookSchema = {
"type": "object",
"required": ["title", "isbn", "authorIds", "bookItems"],
"properties": {
"title": {"type": "string"},
"publicationYear": {"type": "integer"},

--- 페이지 279 끝 ---


--- 페이지 280 ---

252 CHAPTER 12 Advanced data validation
"isbn": {"type": "string"},
"authorIds": {
"type": "array",
"items": {"type": "string"}
},
"bookItems": {
"type": "array",
"items": bookItemSchema
}
}
};
TIP When you define a complex data schema, it is advisable to store nested schemas
in variables to make the schemas easier to read.
Theo Why didn’t you include publicationYear in the list of required fields in the
book schema?
Dave Because, for some books, the publication year is missing. Unlike in OOP, it will
then be easy to deal with nullable fields.
Theo Excellent! And now, please tackle the final piece, the catalog schema.
Dave Here I have a problem. The catalog should be a map with two fields, books-
ByIsbn and authorsById. Both values should be indexes, represented in the
model diagram with curly braces. I have no idea how to define the schema for
an index.
Theo Do you remember how we represent indexes in DOP?
Dave Yes, indexes are represented as maps.
Theo Right, and what’s the difference between those maps and the maps that we use
for records?
Dave For records, we use maps where the names of the fields are known and the val-
ues can have different shapes. For indexes, we use maps where the names of
the fields are unknown and the values have a common shape.
Theo Right. We call the maps for records heterogeneous maps and the maps for
indexes homogeneous maps.
TIP In DOP, records are represented as heterogeneous maps, whereas indexes are repre-
sented as homogeneous maps.
Dave Then how do we define the schema of an homogeneous map in JSON Schema?
Theo I don’t know. Let’s check the JSON Schema online documentation.
 NOTE See https://json-schema.org/ to access the online documentation for JSON
Schema version 2020-12.
After a couple of minutes of digging into the JSON Schema online documentation, Theo
finds a piece about additionalProperties. He studies the information for a while before
making up his mind.

--- 페이지 280 끝 ---
