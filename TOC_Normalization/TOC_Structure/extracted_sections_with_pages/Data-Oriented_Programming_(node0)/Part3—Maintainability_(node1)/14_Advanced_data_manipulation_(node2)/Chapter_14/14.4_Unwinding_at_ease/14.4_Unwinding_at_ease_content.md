# 14.4 Unwinding at ease

**페이지**: 333-334
**계층**: Data-Oriented Programming (node0) > Part3—Maintainability (node1) > 14 Advanced data manipulation (node2) > Chapter 14
**추출 시간**: 2025-08-06 19:47:23

---


--- 페이지 333 ---

14.4 Unwinding at ease 305
{"a": true}
];
var expectedRes = {
"aTrue": 3,
"aFalse": 1
};
_.isEqual(countByBoolField(input, "a", "aTrue", "aFalse"), expectedRes);
Theo Looks good to me. Now, for the implementation of countByBoolField, I
think you are going to need our update function.
Dave I think you’re right. On each iteration, I need to increment the value of either
aTrue or aFalse using update and a function that increments a number by 1.
After a few minutes of trial and error, Dave comes up with the piece of code that uses
reduce, update, and inc. He shows Theo the code for countByBoolField.
Listing14.15 The implementation of countByBoolField
function inc (n) {
return n + 1;
}
function countByBoolField(coll, field, keyTrue, keyFalse) {
return _.reduce(coll, function(res, item) {
if (_.get(item, field)) {
return update(res, keyTrue, inc);
}
return update(res, keyFalse, inc);
}, {[keyTrue]: 0,
Creates a map with
[keyFalse]: 0});
keyTrue and keyFalse
}
associated to 0
Theo Well done! Shall we move on and review the third admin feature?
Dave The third feature is more complicated. I would like to use the teachings from
the first two features for the implementation of the third feature.
Theo OK. Call me when you’re ready for the code review.
14.4 Unwinding at ease
Dave really struggled with the implementation of the last admin feature, grouping books
by a physical library. After a couple of hours of frustration, Dave calls Theo for a rescue.
Dave I really had a hard time implementing the grouping by library feature.
Theo I only have a couple of minutes before my next meeting, but I can try to help
you. What’s the exact definition of grouping by library?
Dave Let me show you the unit test I wrote.

--- 페이지 333 끝 ---


--- 페이지 334 ---

306 CHAPTER 14 Advanced data manipulation
Listing14.16 Unit test for grouping books by a library
var books = [
{
"isbn": "978-1779501127",
"title": "Watchmen",
"bookItems": [
{
"id": "book-item-1",
"libId": "nyc-central-lib",
"isLent": true
}
]
},
{
"isbn": "978-1982137274",
"title": "7 Habits of Highly Effective People",
"bookItems": [
{
"id": "book-item-123",
"libId": "hudson-park-lib",
"isLent": true
},
{
"id": "book-item-17",
"libId": "nyc-central-lib",
"isLent": false
}
]
}
];
var expectedRes =
{
"hudson-park-lib": [
{
"bookItems": {
"id": "book-item-123",
"isLent": true,
"libId": "hudson-park-lib",
},
"isbn": "978-1982137274",
"title": "7 Habits of Highly Effective People",
},
],
"nyc-central-lib": [
{
"bookItems": {
"id": "book-item-1",
"isLent": true,
"libId": "nyc-central-lib",
},
"isbn": "978-1779501127",
"title": "Watchmen",
},

--- 페이지 334 끝 ---
