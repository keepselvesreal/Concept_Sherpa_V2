# 3.2 Representing records as maps

**페이지**: 76-79
**계층**: Data-Oriented Programming (node0) > Part1—Flexibility (node1) > 3 Basic data manipulation (node2) > Chapter 3
**추출 시간**: 2025-08-06 19:46:48

---


--- 페이지 76 ---

48 CHAPTER 3 Basic data manipulation
 NOTE A record is a data structure that groups together related data items. It’s a col-
lection of fields, possibly of different data types.
Theo Is it correct to say that a data entity diagram consists only of records, positional
collections, and indexes?
Joe That’s correct. Can you make a similar statement about the relations between
entities?
Theo The relations in a data entity diagram are either composition (solid line with a
full diamond) or association (dashed line with an empty diamond). Both types
of relations can be either one-to-one, one-to-many, or many-to-many.
Joe Excellent!
TIP A data entity diagram consists of records whose values are either primitives, posi-
tional collections, or indexes. The relation between records is either composition or
association.
3.2 Representing records as maps
So far, we’ve illustrated the benefits we gain from the separation between code and
data at a high-system level. There’s a separation of concerns between code and data,
and each part has clear constraints:
 Code consists of static functions that receive data as an explicit argument.
 Data entities are modeled as records, and the relations between records are
represented by positional collections and indexes.
Now comes the question of the representation of the data. DOP has nothing special
tosay about collections and indexes. However, it’s strongly opinionated about the
representation of records: records should be represented by generic data structures
such as maps.
This applies to both OOP and FP languages. In dynamically-typed languages like
JavaScript, Python, and Ruby, data representation feels natural. While in statically-
typed languages like Java and C#, it is a bit more cumbersome.
Theo I’m really curious to know how we represent positional collections, indexes,
and records in DOP.
Joe Let’s start with positional collections. DOP has nothing special to say about the
representation of collections. They can be linked lists, arrays, vectors, sets, or
other collections best suited for the use case.
Theo It’s like in OOP.
Joe Right! For now, to keep things simple, we’ll use arrays to represent positional
collections.
Theo What about indexes?
Joe Indexes are represented as homogeneous string maps.
Theo What do you mean by a homogeneous map?

--- 페이지 76 끝 ---


--- 페이지 77 ---

3.2 Representing records as maps 49
Joe I mean that all the values of the map are of the same kind. For example, in a
Book index, all the values are Book, and in an author index, all the values are
Author, and so forth.
Theo Again, it’s like in OOP.
 NOTE A homogeneous map is a map where all the values are of the same type. A hetero-
geneous map is a map where the values are of different types.
Joe Now, here’s the big surprise. In DOP, records are represented as maps, more
precisely, heterogeneous string maps.
Joe goes to the whiteboard and begins to draw. When he’s finished, he shows Theo the dia-
gram in figure 3.4.
Record Heterogeneous map
Linked list
Array
Data representation Collection
Set
Vector
Figure 3.4 The building blocks
Index Homogeneous map
of data representation
Theo stays silent for a while. He is shocked to hear that the data entities of a system can be
represented as a generic data structure, where the field names and value types are not
specified in a class. Then, Theo asks Joe:
Theo What are the benefits of this folly?
Joe Flexibility and genericity.
Theo Could you explain, please?
Joe I’ll explain in a moment, but before that, I’d like to show you what an instance
of a record in a DOP system looks like.
Theo OK.
Joe Let’s take as an example, Watchmen, by Alan Moore and Dave Gibbons, which is
my favorite graphic novel. This masterpiece was published in 1987. I’m going
to assume that, in a physical library, there are two copies of this book, whose ID
is nyc-central-lib, and that one of the two copies is currently out. Here’s
how I’d represent the Book record for Watchmen in DOP.
Joe comes closer to Theo’s laptop. He opens a text editor (not an IDE!) and types the Book
record for Theo.

--- 페이지 77 끝 ---


--- 페이지 78 ---

50 CHAPTER 3 Basic data manipulation
Listing3.1 An instance of a Book record represented as a map
{
"isbn": "978-1779501127",
"title": "Watchmen",
"publicationYear": 1987,
"authors": ["alan-moore", "dave-gibbons"],
"bookItems": [
{
"id": "book-item-1",
"libId": "nyc-central-lib",
"isLent": true
},
{
"id": "book-item-2",
"libId": "nyc-central-lib",
"isLent": false
}
]
}
Theo looks at the laptop screen. He has a question.
Theo How am I supposed to instantiate the Book record for Watchmen programmat-
ically?
Joe It depends on the facilities that your programming language offers to instantiate
maps. With dynamic languages like JavaScript, Ruby, or Python, it’s straight-
forward, because we can use literals for maps and arrays. Here, let me show
you how.
Joe jots down the JavaScript code that creates an instance of a Book record, which rep-
resents as a map in JavaScript. He shows the code to Theo.
Listing3.2 A Book record represented as a map in JavaScript
var watchmenBook = {
"isbn": "978-1779501127",
"title": "Watchmen",
"publicationYear": 1987,
"authors": ["alan-moore", "dave-gibbons"],
"bookItems": [
{
"id": "book-item-1",
"libId": "nyc-central-lib",
"isLent": true
},
{
"id": "book-item-2",
"libId": "nyc-central-lib",
"isLent": false
}
]
}

--- 페이지 78 끝 ---


--- 페이지 79 ---

3.2 Representing records as maps 51
Theo And, if I’m in Java?
Joe It’s a bit more tedious, but still doable with the immutable Map and List static
factory methods.
 NOTE See “Creating Immutable Lists, Sets, and Maps” at http://mng.bz/voGm for
more information on this Java core library.
Joe types the Java code to create an instance of a Book record represented as a map. He
shows Theo the Java code.
Listing3.3 A Book record represented as a map in Java
Map watchmen = Map.of(
"isbn", "978-1779501127",
"title", "Watchmen",
"publicationYear", 1987,
"authors", List.of("alan-moore", "dave-gibbons"),
"bookItems", List.of(
Map.of(
"id", "book-item-1",
"libId", "nyc-central-lib",
"isLent", true
),
Map.of (
"id", "book-item-2",
"libId", "nyc-central-lib",
"isLent", false
)
)
);
TIP In DOP, we represent a record as a heterogeneous string map.
Theo I’d definitely prefer to create a Book record using a Book class and a BookItem
class.
Theo opens his IDE. He types the JavaScript code to represent a Book record as an instance
of a Book class.
Listing3.4 A Book record as an instance of a Book class in JavaScript
class Book {
isbn;
title;
publicationYear;
authors;
bookItems;
constructor(isbn, title, publicationYear, authors, bookItems) {
this.isbn = isbn;
this.title = title;
this.publicationYear = publicationYear;
this.authors = authors;
this.bookItems = bookItems;

--- 페이지 79 끝 ---
